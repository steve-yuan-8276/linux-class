---
title: 'Linux运维学习笔记4-4：文件打包压缩工具（一）'
date: 2018-04-11 17:01:13
categories: linux
tags: [centos, linux, zip, notes] 
---

### 写在前面

这则笔记主要整理Linux文件压缩与打包方面的知识，主要涉及gzip、bzip、xz。

### 常见的Linux压缩打包文件

后缀名| 解释
---|---
.gz|gzip压缩工具压缩的文件
.bz2|bzip2压缩工具压缩的文件
.tar|tar工具打包的文件（tar没有压缩功能，只能合并打包）
.tar.gz|先由tar打包，再由zip工具压缩的文件
.tar.bz2|先由tar打包，再由bzip2工具压缩的文件
.tar.xz|先由tar打包，再由xz工具压缩的文件

<!--more-->

### gzip压缩工具

命令行格式： `gzip [参数] [filename]`

**注：**gzip只能压缩文件，不能压缩目录

常用参数：

参数|解释
---|---
-n |n代表压缩等级，从1到9，默认为6，可不加。
-d |表示解压缩
-c |指定目录

#### 示例：

```
gzip 1.txt    //在当前目录下压缩1.txt，源文件会消失，只保留压缩文件

gzip -d 1.txt.gz    //解压1.txt.gz 到当前目录 
```

![](https://farm1.staticflickr.com/815/41384147991_ce30416e03_o.png)

#### 补充视频案例：

##### 准备压缩文件

```
[root@stevey ~]# find /etc/ -type f -name '*conf' -exec cat {} >> b.txt \;
[root@stevey ~]# du -sh b.txt
704K	b.txt
```

##### 压缩文件

```
[root@stevey ~]# gzip b.txt  //压缩b.txt
[root@stevey ~]# ls
1.txt            a.txt     test      test.tar.bz2  test.zip
anaconda-ks.cfg  b.txt.gz  test.tar  test.tar.gz
[root@stevey ~]# du -sh b.txt.gz
616K	b.txt.gz
```

##### 解压缩

- 方法一：`gzip -d [filename]`

```
[root@stevey ~]# gzip -d b.txt.gz
[root@stevey ~]# ls
1.txt            a.txt  test      test.tar.bz2  test.zip
anaconda-ks.cfg  b.txt  test.tar  test.tar.gz
[root@stevey ~]# wc -l b.txt
60410 b.txt
```

- 方法二：`gunzip [参数] [filename]`

```
[root@stevey ~]# gunzip b.txt.gz
```

**注意：**

- `-r` 参数需记忆，表示归递处理，将指定目录下的所有文件及子目录一并处理。

- 平常参数可省略，直接使用`gunzip [filename]`  解压文件。

##### 查看压缩文件 

- 查看压缩文件类型：`file [压缩包名]`

```
[root@stevey ~]# file b.txt.gz  
b.txt.gz: gzip compressed data, was "b.txt", from Unix, last modified: Mon Apr 16 20:44:32 2018
```
- 查看压缩文件内容：`zcat [压缩包名]`

```
[root@stevey ~]# zcat !$ |head   //这里涉及`!$`特殊用法，指的是上一条bash命令的最后一个值，也就是 `b.txt.gz`

zcat b.txt.gz |head
# Generated by NetworkManager
nameserver 129.29.29.29
# The upstream Mozilla.org project tests all changes to the root CA
# list with the NSS (Network Security Services) library.
#
# Occassionally, changes might cause compatibility issues with
# other cryptographic libraries, such as openssl or gnutls.
#
# The package maintainers of the CA certificates package might decide
# to temporarily keep certain (legacy) root CA certificates trusted,
```

##### 进阶技巧：

###### 指定压缩/解压缩保存路径

默认采用`gzip` 压缩，压缩包会放在当前目录下，并删除原文件；使用`-c`参数可以指定压缩包路径，这样原文件就不会被删除了。

- 指定压缩目录 `gzip -c [filename] > [保存目录]`

```
[root@stevey ~]# gzip -c b.txt > /tmp/test/b.txt.gz

```
- 指定解压缩目录 `gzip -d -c [压缩包名] > [指定解压缩文件路径]`

```
[root@stevey ~]# gzip -c b.txt /tmp/test/b.txt.gz > /tmp/c.txt
```

**注意：**

* 这里的解压路径是绝对路径；

* 文件名支持重命名；

校验一下，这两个文件是一模一样的。

```
[root@stevey ~]# wc -l /tmp/test/b.txt
60410 /tmp/test/b.txt
[root@stevey ~]# wc -l b.txt
60410 b.txt
```

### bzip2压缩工具

#### bzip2 安装：

centOS 7 默认没有，需要单独安装 `yum install -y bzip2`

#### bzip2 使用：

命令行格式：`bzip2 [参数] [filename]`

**注：**bzip2 工具也是支持文件压缩，不支持目录压缩。

常用参数

参数|解释
---|---
-z | 表示压缩，可省略
-d | 表示解压缩

示例：

```
bzip2 1.txt   //压缩1.txt
bzip2 -d 1.txt   //解压缩 1.txt.bz2
```

![](https://farm1.staticflickr.com/813/26513702367_0a19c8db86_o.png)

### xz压缩工具

命令行格式： `xz [参数] [filename]`

**注：**bzip2 工具也是支持文件压缩，不支持目录压缩。

常见参数：

参数|解释
---|---
-z | 表示压缩，可省略
-d | 表示解压缩

示例：

```
xz 1.txt   //压缩1.txt
xz -d 1.txt   //解压缩 1.txt.xz
```

![](https://farm1.staticflickr.com/897/41384356831_60612e52d6_o.png)

### 几种压缩工具的比较

网上查了一下，主要是参考以下两篇文章：

* [linux中最佳的压缩格式](https://blog.gtwang.org/linux/linux-why-are-tar-archive-formats-switching-to-xz-compression-to-replace-bzip2-and-what-about-gzip/)

* [Linux下的文件打包和压缩](https://www.jianshu.com/p/38b32107bc3e)

简单归纳一下结论：

压缩工具 | 优点|缺点 | 使用场景
---|---|---|---
zip|资历最老，linux各种版本都支持，可以压缩目录|压缩比、压缩时间都不占优势|基本上是‘老油条’，哪儿都能用，但是不好用
gzip|优势是速度快，压缩比还不错，内存占用小，centos默认安装|压缩比不高，不支持目录压缩|在内存比较小的建议使用
bzip2|压缩比gzip高|压缩时间长；内存占用比gzip大；压缩比不如xz；不支持目录压缩|比gzip好一点，但是又不如xz，处境比较尴尬
xz|2009年诞生的新贵，优点是压缩比显著优于zip、gzip、bzip2等前辈|压缩时间较长，不支持目录压缩|适用于对存储或带宽有严格要求的场景



